# CareLift

## 프로젝트 개요

CareLift는 지하철 엘리베이터를 일반인이 먼저 탑승함으로써 장애인과 교통약자가 이용하지 못하는 문제를 해결하기 위해 기획된 스마트 엘리베이터 제어 시스템입니다.

본 시스템은 교통약자 식별 및 실시간 제어 기능을 통합하여 장애인과 노약자가 보다 **우선적으로 엘리베이터를 이용**할 수 있도록 설계되었습니다.

엘리베이터 앞에 설치된 카메라로 휠체어 사용자를 실시간으로 감지하거나, RFID 태깅을 통해 사용자의 교통약자 여부를 데이터베이스에서 확인하여 엘리베이터의 동작을 제어합니다. 또한 음성 인식을 통해 손을 사용하지 않고도 층수를 선택할 수 있으며, 모든 장치는 서버와의 TCP 통신으로 연동됩니다.

## 시스템 구성

- **STM32F411RE**  
  스텝모터 및 서보모터 제어 (엘리베이터 본체 및 도어 제어)
- **Arduino Nano ESP32**  
  RFID 카드 리더, 버튼, 부저 및 서보모터 제어
- **Jetson Nano + 카메라**  
  YOLOv8을 활용한 휠체어 사용자의 실시간 인식
- **Raspberry Pi 4**  
  Google STT/TTS API 기반의 명령 인식 및 음성 안내, 서버와 TCP 통신
- **Raspberry Pi 4(메인 서버)**  
  각 장치와의 TCP 통신을 통해 데이터를 수신·판단하고, 엘리베이터 동작을 제어하는 **메인 서버** 역할
  
## 담당 역할
본 프로젝트에서는 STM32와 Arduino를 이용한 엘리베이터 하드웨어 제어와  
사용자 인증을 위한 MariaDB 기반 데이터베이스 연동을 담당하였습니다.

### 1. STM32 제어 시스템

- **주요 역할**
  - 엘리베이터 본체를 구동하는 **스텝모터 제어**
  - 도어를 여닫는 **서보모터 제어**
  - 서버 명령을 수신에 따른 실시간 제어 로직 구현

- **스텝모터 제어**
  - 모델: **NK1712S** (1.8°/step, 바이폴라 타입)
  - 안정적인 구동을 위해 **500Hz PWM 주파수** 설정
  - 모터 드라이버로 **A4988** 모듈을 사용하였으며, 안정적인 구동을 위해 **Vref를 약 1.0V로 조정**

- **서보모터 제어**
  - 모델: **SG90**
  - **50Hz PWM 주파수** 설
  - 회전 각도는 Duty Cycle로 조절하며, 속도는 각도 간격 및 딜레이로 제어
 
- **서버 연동**
  - **ESP8266 Wi-Fi 모듈**을 이용하여 TCP 통신 수
  - 서버로부터 `"ELEVATOR_START"` 명령을 수신하면 `operate_elevator()` 함수를 실행하고,  
    엘리베이터 동작 완료 후 `"ARRIVED_DOWNSTAIRS"` 메시지를 서버로 전송

### 2. Arduino 제어 시스템

- **주요 역할**
  - **RFID 카드 인식**을 통한 사용자 식별
  - **버튼 입력** 및 **부저 출력**
  - 엘리베이터 앞 게이트 제어

- **RFID 인식**
  - 모듈: **RC522**
  - RFID 태깅을 통해 ID값을 읽고 서버로 전송
  - 태그 시 부저가 울려 인식 피드백 제공

- **버튼 및 게이트 제어**
  - 버튼 입력 시 탑승 요청 처리
  - RFID 태깅 시, **서보모터가 탑승 게이트를 개방**

### 3. 데이터베이스 연동

- 서버는 수신한 RFID 값을 **MySQL C API**를 통해 **MariaDB**에서 조회하고,  
  해당 사용자가 교통약자인지 판단하여 엘리베이터 동작 여부를 결정합니다.

### 개발 도구
- **STM32CubeIDE**
- **Arduino IDE**
- **Visual Studio Code (Python, YOLO 모델 포함)**

## 작품 외관
![image](https://github.com/user-attachments/assets/ab538870-7f00-4324-9f27-d69fce56a7a7)

## 시연 영상
- [버튼 제어 시연](https://youtube.com/shorts/SQt_mkShKDk)  
- [음성 인식 시연](https://youtube.com/shorts/iNJ-vfX4VzU)  
- [휠체어 우선 탑승 시연](https://youtube.com/shorts/i7uu4Uciq9c)
